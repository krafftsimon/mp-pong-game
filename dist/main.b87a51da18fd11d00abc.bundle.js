webpackJsonp([1],{0:function(t,e,n){t.exports=n("cDNt")},1:function(t,e){},cDNt:function(t,e,n){"use strict";function i(t){return s._18(0,[s._15(402653184,1,{canvas:0}),(t()(),s._3(0,null,null,1,"h1",[],null,null,null,null,null)),(t()(),s._17(null,[" You are in room ",", and are player ",""])),(t()(),s._17(null,["\n"])),(t()(),s._3(0,[[1,0],["gameCanvas",1]],null,0,"canvas",[["height","600"],["width","800"]],null,null,null,null,null)),(t()(),s._17(null,["\n"]))],null,function(t,e){var n=e.component;t(e,2,0,n.roomNum,n.clientPlayerNum)})}function o(t){return s._18(0,[(t()(),s._3(0,null,null,1,"app-root",[],null,[["window","keydown"],["window","keyup"]],function(t,e,n){var i=!0;if("window:keydown"===e){i=!1!==s._14(t,1).keyUp(n)&&i}if("window:keyup"===e){i=!1!==s._14(t,1).keyDown(n)&&i}return i},i,_)),s._1(114688,null,0,y,[a],null,null)],function(t,e){t(e,1,0)},null)}Object.defineProperty(e,"__esModule",{value:!0});var s=n("/oeL"),r={production:!0},u=function(){function t(){}return t}(),l=n("bKpL"),p=n("MjLF"),a=function(){function t(){this.url="http://localhost:4400"}return t.prototype.connect=function(){var t=this;return new l.Observable(function(e){t.socket=p(t.url),t.socket.on("connectToRoom",function(t){e.next(t)})})},t.prototype.getPlayerNumber=function(){var t=this;return new l.Observable(function(e){t.socket.on("playerNumber",function(t){e.next(t)})})},t.prototype.sendUserInput=function(t){this.socket.emit("userInput",t)},t.prototype.getState=function(){var t=this;return new l.Observable(function(e){t.socket.on("gameState",function(t){e.next(t)})})},t}(),c=function(){function t(t){this.y=250,this.speed=10,this.positionBuffer=[],this.x=t}return t.prototype.applyInput=function(t){this.y+=t.direction*this.speed,this.y>500?this.y=500:this.y<0&&(this.y=0)},t}(),h=function(){function t(){this.x=20,this.y=20,this.xspeed=10,this.yspeed=10,this.positionBuffer=[]}return t.prototype.move=function(){this.x+=this.xspeed,this.y+=this.yspeed,this.y>595&&(this.yspeed=-this.yspeed),this.x>795&&(this.xspeed=-this.xspeed),this.y<5&&(this.yspeed=-this.yspeed),this.x<5&&(this.xspeed=-this.xspeed)},t}(),y=function(){function t(t){this.gameService=t,this.updateRate=50,this.directionP1=0,this.interpolationInputs=[],this.pendingInputs=[],this.ballSteps=[],this.player1=new c(20),this.player2=new c(760),this.ball=new h}return t.prototype.keyUp=function(t){38===t.keyCode?this.directionP1=-1:40===t.keyCode&&(this.directionP1=1)},t.prototype.keyDown=function(t){38===t.keyCode?this.directionP1=0:40===t.keyCode&&(this.directionP1=0)},t.prototype.ngOnInit=function(){var t=this;this.gameService.connect().subscribe(function(e){return t.roomNum=e},function(t){return console.log(t)},function(){return console.log("Completed.")}),this.gameService.getPlayerNumber().subscribe(function(e){return t.clientPlayerNum=e},function(t){return console.log(t)},function(){return console.log("Completed.")}),this.setUpdateRate(this.updateRate)},t.prototype.setUpdateRate=function(t){clearInterval(this.updateInterval),this.updateInterval=setInterval(function(t){return function(){t.updateGame()}}(this),1e3/t)},t.prototype.updateGame=function(){this.processServerData(),this.processUserInputs(),this.drawCanvas()},t.prototype.processServerData=function(){var t=this;this.gameService.getState().subscribe(function(e){t.ballSteps=e[t.roomNum-1].ballSteps})},t.prototype.processUserInputs=function(){var t={direction:this.directionP1,playerNum:this.clientPlayerNum,roomNum:this.roomNum};void 0!==this.roomNum&&this.gameService.sendUserInput(t),1===this.clientPlayerNum?(this.player1.applyInput(t),this.pendingInputs.push({input:t,predictedPosition:this.player1.y})):(this.player2.applyInput(t),this.pendingInputs.push({input:t,predictedPosition:this.player2.y}))},t.prototype.interpolate=function(){this.ball.x=this.ballSteps[0].x,this.ball.y=this.ballSteps[0].y,this.ballSteps.shift(),1===this.clientPlayerNum&&(this.player2.applyInput(this.interpolationInputs[0]),this.interpolationInputs.shift()),2===this.clientPlayerNum&&(this.player1.applyInput(this.interpolationInputs[0]),this.interpolationInputs.shift())},t.prototype.drawCanvas=function(){var t=this.canvas.nativeElement.getContext("2d");t.clearRect(0,0,800,600),t.beginPath(),t.rect(this.player1.x,this.player1.y,20,100),t.rect(this.player2.x,this.player2.y,20,100),t.stroke(),t.beginPath(),t.arc(this.ball.x,this.ball.y,5,0,2*Math.PI),t.stroke()},t.ctorParameters=function(){return[{type:a}]},t}(),d=["canvas[_ngcontent-%COMP%]{border:1px solid red;margin:40px auto;display:block}"],f=[d],_=s._0({encapsulation:0,styles:f,data:{}}),b=s.Y("app-root",y,o,{},{},[]),m=n("qbdv"),v=n("fc+i"),g=s.Z(u,[y],function(t){return s._12([s._13(512,s.i,s.W,[[8,[b]],[3,s.i],s.x]),s._13(5120,s.v,s._11,[[3,s.v]]),s._13(4608,m.d,m.c,[s.v]),s._13(4608,s.h,s.h,[]),s._13(5120,s.a,s._4,[]),s._13(5120,s.t,s._9,[]),s._13(5120,s.u,s._10,[]),s._13(4608,v.b,v.s,[m.b]),s._13(6144,s.H,null,[v.b]),s._13(4608,v.e,v.f,[]),s._13(5120,v.c,function(t,e,n,i){return[new v.k(t),new v.o(e),new v.n(n,i)]},[m.b,m.b,m.b,v.e]),s._13(4608,v.d,v.d,[v.c,s.z]),s._13(135680,v.m,v.m,[m.b]),s._13(4608,v.l,v.l,[v.d,v.m]),s._13(6144,s.F,null,[v.l]),s._13(6144,v.p,null,[v.m]),s._13(4608,s.L,s.L,[s.z]),s._13(4608,v.g,v.g,[m.b]),s._13(4608,v.i,v.i,[m.b]),s._13(4608,a,a,[]),s._13(512,m.a,m.a,[]),s._13(1024,s.l,v.q,[]),s._13(1024,s.b,function(t,e){return[v.r(t,e)]},[[2,v.h],[2,s.y]]),s._13(512,s.c,s.c,[[2,s.b]]),s._13(131584,s._2,s._2,[s.z,s.X,s.r,s.l,s.i,s.c]),s._13(2048,s.e,null,[s._2]),s._13(512,s.d,s.d,[s.e]),s._13(512,v.a,v.a,[[3,v.a]]),s._13(512,u,u,[])])});r.production&&Object(s.R)(),Object(v.j)().bootstrapModuleFactory(g).catch(function(t){return console.log(t)})},gFIY:function(t,e){function n(t){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+t+"'.")})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="gFIY"}},[0]);