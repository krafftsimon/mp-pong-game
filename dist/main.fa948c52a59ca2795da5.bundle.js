webpackJsonp([1],{0:function(t,e,n){t.exports=n("cDNt")},1:function(t,e){},cDNt:function(t,e,n){"use strict";function i(t){return r._18(0,[r._15(402653184,1,{canvas:0}),(t()(),r._3(0,null,null,1,"h1",[],null,null,null,null,null)),(t()(),r._17(null,[" You are in room ",", and are player ",""])),(t()(),r._17(null,["\n"])),(t()(),r._3(0,[[1,0],["gameCanvas",1]],null,0,"canvas",[["height","600"],["width","800"]],null,null,null,null,null)),(t()(),r._17(null,["\n"]))],null,function(t,e){var n=e.component;t(e,2,0,n.roomNum,n.clientPlayerNum)})}function o(t){return r._18(0,[(t()(),r._3(0,null,null,1,"app-root",[],null,[["window","keydown"],["window","keyup"]],function(t,e,n){var i=!0;if("window:keydown"===e){i=!1!==r._14(t,1).keyUp(n)&&i}if("window:keyup"===e){i=!1!==r._14(t,1).keyDown(n)&&i}return i},i,m)),r._1(114688,null,0,h,[a],null,null)],function(t,e){t(e,1,0)},null)}Object.defineProperty(e,"__esModule",{value:!0});var r=n("/oeL"),u={production:!0},s=function(){function t(){}return t}(),l=n("bKpL"),p=n("MjLF"),a=function(){function t(){this.url="http://35.193.240.128:4400"}return t.prototype.connect=function(){var t=this;return new l.Observable(function(e){t.socket=p(t.url),t.socket.on("connectToRoom",function(t){e.next(t)})})},t.prototype.getPlayerNumber=function(){var t=this;return new l.Observable(function(e){t.socket.on("playerNumber",function(t){e.next(t)})})},t.prototype.sendUserInput=function(t){this.socket.emit("userInput",t)},t.prototype.getState=function(){var t=this;return new l.Observable(function(e){t.socket.on("gameState",function(t){e.next(t)})})},t}(),c=function(){function t(t){this.y=250,this.speed=10,this.positionBuffer=[],this.x=t}return t.prototype.applyInput=function(t){this.y+=t.direction*this.speed,this.y>500?this.y=500:this.y<0&&(this.y=0)},t}(),y=function(){function t(){this.x=20,this.y=20,this.xspeed=10,this.yspeed=10,this.positionBuffer=[]}return t.prototype.move=function(){this.x+=this.xspeed,this.y+=this.yspeed,this.y>595&&(this.yspeed=-this.yspeed),this.x>795&&(this.xspeed=-this.xspeed),this.y<5&&(this.yspeed=-this.yspeed),this.x<5&&(this.xspeed=-this.xspeed)},t}(),h=function(){function t(t){this.gameService=t,this.updateRate=50,this.directionP1=0,this.pendingInputs=[],this.player1=new c(20),this.player2=new c(760),this.ball=new y}return t.prototype.keyUp=function(t){38===t.keyCode?this.directionP1=-1:40===t.keyCode&&(this.directionP1=1)},t.prototype.keyDown=function(t){38===t.keyCode?this.directionP1=0:40===t.keyCode&&(this.directionP1=0)},t.prototype.ngOnInit=function(){var t=this;this.gameService.connect().subscribe(function(e){return t.roomNum=e},function(t){return console.log(t)},function(){return console.log("Completed.")}),this.gameService.getPlayerNumber().subscribe(function(e){return t.clientPlayerNum=e},function(t){return console.log(t)},function(){return console.log("Completed.")}),this.setUpdateRate(this.updateRate)},t.prototype.setUpdateRate=function(t){clearInterval(this.updateInterval),this.updateInterval=setInterval(function(t){return function(){t.updateGame()}}(this),1e3/t)},t.prototype.updateGame=function(){this.processServerData(),this.processUserInputs(),this.drawCanvas()},t.prototype.processServerData=function(){var t=this;this.gameService.getState().subscribe(function(e){if(1===t.clientPlayerNum){t.player2.y=e[t.roomNum-1].player2.y;var n=e[t.roomNum-1].inputsP1;for(var i in n)n[i].result!=t.pendingInputs[i]&&(t.player1.y=e[t.roomNum-1].player1.y);t.pendingInputs=[]}if(2===t.clientPlayerNum){t.player1.y=e[t.roomNum-1].player1.y;var n=e[t.roomNum-1].inputsP2;for(var i in n)n[i].result!=t.pendingInputs[i]&&(t.player2.y=e[t.roomNum-1].player2.y);t.pendingInputs=[]}t.ball.x=e[t.roomNum-1].ball.x,t.ball.y=e[t.roomNum-1].ball.y})},t.prototype.processUserInputs=function(){var t={direction:this.directionP1,playerNum:this.clientPlayerNum,roomNum:this.roomNum};void 0!==this.roomNum&&this.gameService.sendUserInput(t),1===this.clientPlayerNum?(this.player1.applyInput(t),this.pendingInputs.push({input:t,predictedPosition:this.player1.y})):(this.player2.applyInput(t),this.pendingInputs.push({input:t,predictedPosition:this.player2.y}))},t.prototype.drawCanvas=function(){var t=this.canvas.nativeElement.getContext("2d");t.clearRect(0,0,800,600),t.beginPath(),t.rect(this.player1.x,this.player1.y,20,100),t.rect(this.player2.x,this.player2.y,20,100),t.stroke(),t.beginPath(),t.arc(this.ball.x,this.ball.y,5,0,2*Math.PI),t.stroke()},t.ctorParameters=function(){return[{type:a}]},t}(),d=["canvas[_ngcontent-%COMP%]{border:1px solid red;margin:40px auto;display:block}"],f=[d],m=r._0({encapsulation:0,styles:f,data:{}}),_=r.Y("app-root",h,o,{},{},[]),v=n("qbdv"),b=n("fc+i"),g=r.Z(s,[h],function(t){return r._12([r._13(512,r.i,r.W,[[8,[_]],[3,r.i],r.x]),r._13(5120,r.v,r._11,[[3,r.v]]),r._13(4608,v.d,v.c,[r.v]),r._13(4608,r.h,r.h,[]),r._13(5120,r.a,r._4,[]),r._13(5120,r.t,r._9,[]),r._13(5120,r.u,r._10,[]),r._13(4608,b.b,b.s,[v.b]),r._13(6144,r.H,null,[b.b]),r._13(4608,b.e,b.f,[]),r._13(5120,b.c,function(t,e,n,i){return[new b.k(t),new b.o(e),new b.n(n,i)]},[v.b,v.b,v.b,b.e]),r._13(4608,b.d,b.d,[b.c,r.z]),r._13(135680,b.m,b.m,[v.b]),r._13(4608,b.l,b.l,[b.d,b.m]),r._13(6144,r.F,null,[b.l]),r._13(6144,b.p,null,[b.m]),r._13(4608,r.L,r.L,[r.z]),r._13(4608,b.g,b.g,[v.b]),r._13(4608,b.i,b.i,[v.b]),r._13(4608,a,a,[]),r._13(512,v.a,v.a,[]),r._13(1024,r.l,b.q,[]),r._13(1024,r.b,function(t,e){return[b.r(t,e)]},[[2,b.h],[2,r.y]]),r._13(512,r.c,r.c,[[2,r.b]]),r._13(131584,r._2,r._2,[r.z,r.X,r.r,r.l,r.i,r.c]),r._13(2048,r.e,null,[r._2]),r._13(512,r.d,r.d,[r.e]),r._13(512,b.a,b.a,[[3,b.a]]),r._13(512,s,s,[])])});u.production&&Object(r.R)(),Object(b.j)().bootstrapModuleFactory(g).catch(function(t){return console.log(t)})},gFIY:function(t,e){function n(t){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+t+"'.")})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="gFIY"}},[0]);