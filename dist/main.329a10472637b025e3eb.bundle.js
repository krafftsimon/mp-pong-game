webpackJsonp([1],{0:function(t,n,e){t.exports=e("cDNt")},1:function(t,n){},cDNt:function(t,n,e){"use strict";function i(t){return a._19(0,[a._16(402653184,1,{canvas:0}),(t()(),a._4(0,null,null,1,"h1",[],null,null,null,null,null)),(t()(),a._18(null,[" You are in room ",", and are player ",""])),(t()(),a._18(null,["\n"])),(t()(),a._4(0,[[1,0],["gameCanvas",1]],null,0,"canvas",[["height","600"],["width","800"]],null,null,null,null,null)),(t()(),a._18(null,["\n"]))],null,function(t,n){var e=n.component;t(n,2,0,e.roomNum,e.clientPlayerNum)})}function s(t){return a._19(0,[(t()(),a._4(0,null,null,1,"app-root",[],null,[["window","keydown"],["window","keyup"]],function(t,n,e){var i=!0;if("window:keydown"===n){i=!1!==a._15(t,1).keyUp(e)&&i}if("window:keyup"===n){i=!1!==a._15(t,1).keyDown(e)&&i}return i},i,f)),a._2(4308992,null,0,y,[c,a.F],null,null)],function(t,n){t(n,1,0)},null)}Object.defineProperty(n,"__esModule",{value:!0});var a=e("/oeL"),o={production:!0},r=function(){function t(){}return t}(),h=e("bKpL"),l=e("MjLF"),c=function(){function t(){this.devUrl="http://localhost:4400",this.prodUrl="http://pong.krafftsimon.com",this.url=this.prodUrl}return t.prototype.connect=function(){var t=this;return new h.Observable(function(n){t.socket=l(t.url),t.socket.on("connectToRoom",function(t){n.next(t)})})},t.prototype.getPlayerNumber=function(){var t=this;return new h.Observable(function(n){t.socket.on("playerNumber",function(t){n.next(t)})})},t.prototype.sendUserInput=function(t){this.socket.emit("userInput",t)},t.prototype.getState=function(){var t=this;return new h.Observable(function(n){t.socket.on("gameState",function(t){n.next(t)})})},t.prototype.getBallPosition=function(){var t=this;return new h.Observable(function(n){t.socket.on("ballPosition",function(t){n.next(t)})})},t}(),u=function(){function t(t){this.x=t,this.y=250,this.width=20,this.length=105,this.speed=10,this.positionBuffer=[]}return t.prototype.applyInput=function(t){this.y+=t.direction*this.speed,this.y>600-this.length?this.y=600-this.length:this.y<0&&(this.y=0)},t}(),p=function(){function t(){this.x=400,this.y=300,this.xSpeed=5,this.ySpeed=5,this.positionBuffer=[]}return t.prototype.move=function(t,n){this.x+=this.xSpeed,this.y+=this.ySpeed,this.y>595&&(this.ySpeed=-this.ySpeed),this.x>795&&(this.xSpeed=-this.xSpeed),this.y<5&&(this.ySpeed=-this.ySpeed),this.x<5&&(this.x=400,this.y=250),this.x<=45&&this.x>=40&&this.y+5>=t.y&&this.y-5<=t.y+100||this.x>=755&&this.x<=760&&this.y+5>=n.y&&this.y-5<=n.y+100?this.xSpeed=-this.xSpeed:(this.x>=20&&this.x<=40&&this.y+5>=t.y&&this.y<=t.y+10||this.x>=20&&this.x<=40&&this.y-5<=t.y+100&&this.y>=t.y+90||this.x>=760&&this.x<=780&&this.y+5>=n.y&&this.y<=n.y+10||this.x>=760&&this.x<=780&&this.y-5<=n.y+100&&this.y>=n.y+90)&&(this.ySpeed=-this.ySpeed)},t}(),y=function(){function t(t,n){this.gameService=t,this.renderer=n,this.updateRate=50,this.direction=0,this.ballMovementCounter=0,this.interpolationInputs=[],this.pendingInputs=[],this.ballSteps=[],this.inputNumber=0,this.menuScreen=!0,this.connectBtnX=300,this.connectBtnY=300,this.connectBtnWidth=100,this.connectBtnLength=200,this.countDown="3",this.countDownStarted=!1,this.pointsP1="0",this.pointsP2="0",this.powerupIconSize=64,this.player1=new u(20),this.player2=new u(760),this.ball=new p,this.ball2=new p,this.paddleSound=new Audio,this.paddleSound.src="../assets/Sound - Headshot 1x.mp3",this.paddleSound.volume=.2,this.paddleSound.load(),this.serverData={playersInRoom:[],player1:new u(20),player2:new u(760),inputsP1:[],inputsP2:[],lastProcessedInputP1:0,lastProcessedInputP2:0,ballSteps:[],pointsP1:0,pointsP2:0,gameState:"waitingForPlayer",powerupOnBoard:0,powerupsActive:[!1,!1,!1,!1,!1],powerupX:200,powerupY:200}}return t.prototype.keyUp=function(t){38===t.keyCode?this.direction=-1:40===t.keyCode&&(this.direction=1)},t.prototype.keyDown=function(t){38===t.keyCode?this.direction=0:40===t.keyCode&&(this.direction=0)},t.prototype.ngOnInit=function(){var t=this;this.renderer.listen(this.canvas.nativeElement,"click",function(n){t.menuScreen&&n.layerX>=t.connectBtnX&&n.layerY>=t.connectBtnY&&n.layerX<=t.connectBtnX+t.connectBtnLength&&n.layerY<=t.connectBtnX+t.connectBtnWidth&&(t.menuScreen=!1,t.startGame())})},t.prototype.ngAfterViewInit=function(){this.canvasCtx=this.canvas.nativeElement.getContext("2d"),this.drawMenu()},t.prototype.startGame=function(){var t=this;this.gameService.connect().subscribe(function(n){return t.roomNum=n},function(t){return console.log(t)},function(){return console.log("Completed.")}),this.gameService.getPlayerNumber().subscribe(function(n){return t.clientPlayerNum=n},function(t){return console.log(t)},function(){return console.log("Completed.")}),this.subscribeToServer(),this.setUpdateRate(this.updateRate)},t.prototype.setUpdateRate=function(t){clearInterval(this.updateInterval),this.updateInterval=setInterval(function(t){return function(){t.updateGame()}}(this),1e3/t)},t.prototype.updateGame=function(){"starting"!==this.serverData.gameState||this.countDownStarted||(this.player1.y=250,this.player2.y=250,this.startCountDown(),this.countDownStarted=!0),"started"===this.serverData.gameState&&(this.processServerData(),this.processUserInputs(),this.interpolate()),this.drawGame()},t.prototype.subscribeToServer=function(){var t=this;this.gameService.getState().subscribe(function(n){t.serverData=n[t.roomNum-1],t.ballMovementCounter=0},function(t){return console.log(t)},function(){return console.log("Completed.")}),this.gameService.getBallPosition().subscribe(function(n){return t.serverBall=n[t.roomNum-1]},function(t){return console.log(t)},function(){return console.log("Completed.")})},t.prototype.processServerData=function(){if(1===this.clientPlayerNum){this.player1.y=this.serverData.player1.y,this.player1.length=this.serverData.player1.length,this.interpolationInputs=this.serverData.inputsP2;for(var t=0;t<this.pendingInputs.length;)this.pendingInputs[t].inputNumber<=this.serverData.lastProcessedInputP1?this.pendingInputs.splice(t,1):(this.player1.applyInput(this.pendingInputs[t]),t++)}else if(2===this.clientPlayerNum){this.player2.y=this.serverData.player2.y,this.player2.length=this.serverData.player2.length,this.interpolationInputs=this.serverData.inputsP1;for(var t=0;t<this.pendingInputs.length;)this.pendingInputs[t].inputNumber<=this.serverData.lastProcessedInputP2?this.pendingInputs.splice(t,1):(this.player2.applyInput(this.pendingInputs[t]),t++)}},t.prototype.processUserInputs=function(){if(this.ball.x=this.serverBall.x,this.ball.y=this.serverBall.y,this.ball.x<=50&&this.ball.y>=this.player1.y-10&&this.ball.y<=this.player1.y+115&&this.paddleSound.play(),this.ball.x>=750&&this.ball.y>=this.player2.y-10&&this.ball.y<=this.player2.y+115&&this.paddleSound.play(),0!==this.direction){var t={direction:this.direction,inputNumber:this.inputNumber++,playerNum:this.clientPlayerNum,roomNum:this.roomNum};void 0!==this.roomNum&&this.gameService.sendUserInput(t),1===this.clientPlayerNum?(this.player1.applyInput(t),this.pendingInputs.push(t)):(this.player2.applyInput(t),this.pendingInputs.push(t))}},t.prototype.interpolate=function(){this.interpolationInputs.length>0&&(1===this.clientPlayerNum?(this.player2.applyInput(this.interpolationInputs[0]),this.interpolationInputs.shift()):2===this.clientPlayerNum&&(this.player1.applyInput(this.interpolationInputs[0]),this.interpolationInputs.shift()))},t.prototype.startCountDown=function(){setTimeout(function(){this.countDown="2"}.bind(this),1e3),setTimeout(function(){this.countDown="1"}.bind(this),2e3),setTimeout(function(){this.countDown="3",this.countDownStarted=!1}.bind(this),3e3)},t.prototype.drawGame=function(){this.canvasCtx.clearRect(0,0,800,600);var t=this.canvasCtx.createRadialGradient(400,300,80,400,300,600);t.addColorStop(0,"#e5e5e5"),t.addColorStop(1,"#b2b2b2"),this.canvasCtx.fillStyle=t,this.canvasCtx.fillRect(0,0,800,600),this.canvasCtx.shadowBlur=0,this.canvasCtx.shadowOffsetY=0,this.canvasCtx.shadowOffsetX=0,this.canvasCtx.shadowColor="grey",this.canvasCtx.beginPath(),this.canvasCtx.moveTo(400,0),this.canvasCtx.lineTo(400,600),this.canvasCtx.stroke(),"waitingForPlayer"===this.serverData.gameState&&(this.canvasCtx.fillStyle="black",this.canvasCtx.font="30px Comic Sans MS",this.canvasCtx.fillText("Waiting for an opponent.",220,250)),"starting"===this.serverData.gameState&&(this.canvasCtx.fillStyle="black",this.canvasCtx.font="60px Comic Sans MS",this.canvasCtx.fillText(this.countDown,380,250)),this.canvasCtx.shadowBlur=10,this.canvasCtx.shadowOffsetY=10,this.canvasCtx.shadowOffsetX=10,this.canvasCtx.shadowColor="grey",this.canvasCtx.beginPath(),this.canvasCtx.fillStyle="#68EFAD",this.canvasCtx.lineWidth=1,this.canvasCtx.strokeStyle="grey",this.canvasCtx.arc(this.ball.x,this.ball.y,10,0,2*Math.PI),this.canvasCtx.fill(),this.canvasCtx.stroke(),this.canvasCtx.font="40px Comic Sans MS",this.canvasCtx.fillText(this.serverData.pointsP1,300,40),this.canvasCtx.fillText(this.serverData.pointsP2,475,40),this.canvasCtx.beginPath(),this.canvasCtx.fillStyle="#691A99",this.canvasCtx.lineWidth=2,this.canvasCtx.strokeStyle="grey",this.canvasCtx.rect(this.player1.x,this.player1.y,this.serverData.player1.width,this.serverData.player1.length),this.canvasCtx.rect(this.player2.x,this.player2.y,this.serverData.player2.width,this.serverData.player2.length),this.canvasCtx.fill(),this.canvasCtx.stroke()},t.prototype.drawMenu=function(){this.canvasCtx.fillStyle="#e5e5e5",this.canvasCtx.fillRect(0,0,800,600),this.canvasCtx.fillStyle="black",this.canvasCtx.font="40px Comic Sans MS",this.canvasCtx.fillText("Online Multiplayer Pong Game",120,80),this.canvasCtx.fillText("Connect",this.connectBtnX+25,this.connectBtnY+60),this.canvasCtx.rect(this.connectBtnX,this.connectBtnY,this.connectBtnLength,this.connectBtnWidth),this.canvasCtx.stroke()},t.ctorParameters=function(){return[{type:c},{type:a.F}]},t}(),d=["canvas[_ngcontent-%COMP%]{box-shadow:0 0 10px 2px #691a99;margin:40px auto;display:block}h1[_ngcontent-%COMP%]{text-align:center}"],v=[d],f=a._1({encapsulation:0,styles:v,data:{}}),x=a.Z("app-root",y,s,{},{},[]),m=e("qbdv"),g=e("fc+i"),b=a._0(r,[y],function(t){return a._13([a._14(512,a.i,a.X,[[8,[x]],[3,a.i],a.x]),a._14(5120,a.v,a._12,[[3,a.v]]),a._14(4608,m.d,m.c,[a.v]),a._14(4608,a.h,a.h,[]),a._14(5120,a.a,a._5,[]),a._14(5120,a.t,a._10,[]),a._14(5120,a.u,a._11,[]),a._14(4608,g.b,g.s,[m.b]),a._14(6144,a.I,null,[g.b]),a._14(4608,g.e,g.f,[]),a._14(5120,g.c,function(t,n,e,i){return[new g.k(t),new g.o(n),new g.n(e,i)]},[m.b,m.b,m.b,g.e]),a._14(4608,g.d,g.d,[g.c,a.z]),a._14(135680,g.m,g.m,[m.b]),a._14(4608,g.l,g.l,[g.d,g.m]),a._14(6144,a.G,null,[g.l]),a._14(6144,g.p,null,[g.m]),a._14(4608,a.M,a.M,[a.z]),a._14(4608,g.g,g.g,[m.b]),a._14(4608,g.i,g.i,[m.b]),a._14(4608,c,c,[]),a._14(512,m.a,m.a,[]),a._14(1024,a.l,g.q,[]),a._14(1024,a.b,function(t,n){return[g.r(t,n)]},[[2,g.h],[2,a.y]]),a._14(512,a.c,a.c,[[2,a.b]]),a._14(131584,a._3,a._3,[a.z,a.Y,a.r,a.l,a.i,a.c]),a._14(2048,a.e,null,[a._3]),a._14(512,a.d,a.d,[a.e]),a._14(512,g.a,g.a,[[3,g.a]]),a._14(512,r,r,[])])});o.production&&Object(a.S)(),Object(g.j)().bootstrapModuleFactory(b).catch(function(t){return console.log(t)})},gFIY:function(t,n){function e(t){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+t+"'.")})}e.keys=function(){return[]},e.resolve=e,t.exports=e,e.id="gFIY"}},[0]);